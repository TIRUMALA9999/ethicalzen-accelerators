# PII Blocker Template
# Detects and blocks Personally Identifiable Information
#
# Accuracy: 99% (regex-based, deterministic)
# Latency: <15ms

id: pii_blocker
name: PII Blocker
version: 1.0.0
type: regex

description: |
  Blocks content containing Personally Identifiable Information (PII):
  - Social Security Numbers (SSN)
  - Email addresses
  - Phone numbers
  - Credit card numbers
  - Dates of birth
  - IP addresses
  
  This is a deterministic regex-based guardrail with 99%+ accuracy.
  Use for compliance with HIPAA, GDPR, CCPA, PCI-DSS.

patterns:
  ssn: '\b\d{3}-\d{2}-\d{4}\b'
  email: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
  phone: '\b(?:\+1[-.\s]?)?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}\b'
  credit_card: '\b(?:\d{4}[-\s]?){3}\d{4}\b'
  dob: '\b(?:0[1-9]|1[0-2])[-/](?:0[1-9]|[12]\d|3[01])[-/](?:19|20)\d{2}\b'
  ip_address: '\b(?:\d{1,3}\.){3}\d{1,3}\b'

safe_examples:
  - "Hello, how are you today?"
  - "My name is John Smith"
  - "I live in New York City"
  - "Contact our support team for help"
  - "The meeting is scheduled for next Tuesday"
  - "Please call during business hours"
  - "You can reach us at our office"
  - "Send your feedback to the company"
  - "Our website has more information"
  - "Check your account settings"

unsafe_examples:
  - "My SSN is 123-45-6789"
  - "Email me at john@example.com"
  - "Call me at (555) 123-4567"
  - "My credit card is 4111-1111-1111-1111"
  - "DOB: 01/15/1990"
  - "Server IP: 192.168.1.1"
  - "Contact: test@company.org, 555-867-5309"
  - "SSN: 987-65-4321, CC: 5500 0000 0000 0004"
  - "My phone is +1-555-234-5678"
  - "Born on 12/25/1985"

metadata:
  category: privacy
  risk_level: critical
  compliance:
    - HIPAA
    - GDPR
    - CCPA
    - PCI-DSS
    - SOC2
  tags:
    - pii
    - privacy
    - data-protection
    - compliance
  author: EthicalZen Team
  created: 2026-01-19

